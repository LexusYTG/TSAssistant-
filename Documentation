# TS Assistant - Documentaci√≥n T√©cnica Completa

## üìã √çNDICE
1. [VISI√ìN GENERAL](#visi√≥n-general)
2. [ARQUITECTURA DEL SISTEMA](#arquitectura-del-sistema)
3. [M√ìDULO VOICERECORDER](#m√≥dulo-voicerecorder)
4. [M√ìDULO TTSMANAGER](#m√≥dulo-ttsmanager)
5. [M√ìDULO COMMANDPROCESSOR](#m√≥dulo-commandprocessor)
6. [M√ìDULO MAINACTIVITY](#m√≥dulo-mainactivity)
7. [FLUJO DE TRABAJO](#flujo-de-trabajo)
8. [COMANDOS SOPORTADOS](#comandos-soportados)
9. [PERMISOS REQUERIDOS](#permisos-requeridos)
10. [ALMACENAMIENTO DE DATOS](#almacenamiento-de-datos)
11. [MANEJO DE ERRORES](#manejo-de-errores)
12. [CONSIDERACIONES DE DISE√ëO](#consideraciones-de-dise√±o)

---

## VISI√ìN GENERAL

TS Assistant es un asistente de voz completo para Android, desarrollado enteramente en Java, que permite controlar el dispositivo mediante comandos de voz en espa√±ol. Funciona parcialmente sin conexi√≥n a internet y ofrece una interfaz visual atractiva con animaciones y retroalimentaci√≥n en tiempo real.

**Caracter√≠sticas principales:**
- Reconocimiento de voz en espa√±ol (es-ES)
- S√≠ntesis de voz (TTS) en espa√±ol
- M√°s de 50 comandos diferentes
- Interfaz minimalista con visualizador de audio animado
- Sistema de cach√© para apps, contactos y m√∫sica
- Funcionamiento offline para comandos b√°sicos
- Manejo robusto de permisos

---

## ARQUITECTURA DEL SISTEMA

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                MainActivity                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  TTS     ‚îÇ ‚îÇ  Voz     ‚îÇ ‚îÇ   Procesador   ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ Manager  ‚îÇ ‚îÇ Recorder ‚îÇ ‚îÇ de Comandos    ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ         UI ‚Ä¢ Permisos ‚Ä¢ Animaciones            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Flujo de datos:**
1. Voz del usuario ‚Üí VoiceRecorder ‚Üí Texto
2. Texto ‚Üí CommandProcessor ‚Üí Acci√≥n/Intenci√≥n
3. Respuesta ‚Üí TTSManager ‚Üí Voz sintetizada
4. Feedback ‚Üí MainActivity ‚Üí UI actualizada

---

## M√ìDULO VOICERECORDER

### Prop√≥sito
Maneja el reconocimiento de voz a texto usando el servicio de Google Speech Recognition integrado en Android.

### Caracter√≠sticas Clave
- **Idioma fijo espa√±ol**: Siempre usa "es-ES"
- **Timeout autom√°tico**: 8 segundos m√°ximo por escucha
- **Manejo offline**: Ignora errores de red para funcionamiento sin conexi√≥n
- **Resultados parciales**: Soporte para resultados en tiempo real (API 14+)

### Estructura Interna

```java
// Componentes principales:
- SpeechRecognizer: Motor de reconocimiento de Android
- RecognitionListener: Callbacks para eventos de reconocimiento
- Handler + Runnable: Sistema de timeout
- Intent: Configuraci√≥n del reconocedor

// Estados:
- isReady: Inicializaci√≥n exitosa
- isListening: Actualmente grabando/escuchando
```

### M√©todos P√∫blicos

| M√©todo | Descripci√≥n | Return |
|--------|-------------|---------|
| `isRecognitionAvailable()` | Verifica si el servicio est√° disponible | boolean |
| `startListening()` | Inicia la captura de voz | void |
| `stopListening()` | Detiene la captura (nuevo) | void |
| `isListening()` | Estado actual de escucha | boolean |
| `destroy()` | Libera recursos | void |

### Manejo de Errores
```java
// Errores IGNORADOS (modo offline):
- ERROR_NETWORK
- ERROR_NETWORK_TIMEOUT  
- ERROR_SERVER

// Errores REPORTADOS:
- ERROR_NO_MATCH: No se reconoci√≥ voz
- ERROR_SPEECH_TIMEOUT: Silencio prolongado
- ERROR_AUDIO: Problemas de micr√≥fono
- ERROR_INSUFFICIENT_PERMISSIONS: Sin permiso RECORD_AUDIO
```

### Configuraci√≥n del Reconocedor
```java
recognizerIntent.putExtra(RecognizerIntent.EXTRA_LANGUAGE, "es-ES");
recognizerIntent.putExtra(RecognizerIntent.EXTRA_MAX_RESULTS, 3);
recognizerIntent.putExtra(RecognizerIntent.EXTRA_PARTIAL_RESULTS, true);
```

---

## M√ìDULO TTSMANAGER

### Prop√≥sito
Gestiona la s√≠ntesis de texto a voz (Text-to-Speech) usando el motor TTS de Android.

### Patr√≥n de Dise√±o
- **Singleton**: Una √∫nica instancia en toda la aplicaci√≥n
- **Callback pattern**: Notificaciones de inicio/fin de speech

### Configuraci√≥n de Voz
```java
// Idioma principal: espa√±ol de Espa√±a
Locale spanish = new Locale("es", "ES");

// Fallback: espa√±ol neutro o idioma del sistema
if (result == TextToSpeech.LANG_MISSING_DATA || 
    result == TextToSpeech.LANG_NOT_SUPPORTED) {
    tts.setLanguage(Locale.getDefault());
}

// Par√°metros de voz:
tts.setSpeechRate(1.0f);  // Velocidad normal
tts.setPitch(1.0f);       // Tono normal
```

### Sistema de Callbacks
```java
tts.setOnUtteranceProgressListener(new UtteranceProgressListener() {
    @Override public void onStart(String utteranceId) {
        // Se llama cuando comienza a hablar
        callback.onSpeechStart();
    }
    
    @Override public void onDone(String utteranceId) {
        // Se llama cuando termina de hablar
        callback.onSpeechDone();
    }
    
    @Override public void onError(String utteranceId) {
        // Error en TTS, pero notifica como completado
        callback.onSpeechDone();
    }
});
```

### M√©todos Principales

| M√©todo | Descripci√≥n | Par√°metros |
|--------|-------------|------------|
| `getInstance()` | Obtiene instancia singleton | Context |
| `speak()` | Reproduce texto | String text |
| `setCallback()` | Establece listener | TTSCallback |
| `shutdown()` | Libera recursos TTS | void |

### Gesti√≥n de Colas
```java
// Sistema FIFO (First In, First Out)
tts.speak(text, TextToSpeech.QUEUE_ADD, null, utteranceId);
// QUEUE_ADD: Agrega al final de la cola
// QUEUE_FLUSH: Borra cola y reproduce inmediato
```

---

## M√ìDULO COMMANDPROCESSOR

### Prop√≥sito
Interpreta comandos de voz y ejecuta las acciones correspondientes. Es el "cerebro" del asistente.

### Arquitectura de Comandos

#### 1. Sistema de Mapeo
```java
// COMMAND_MAP: Diccionario palabra ‚Üí comando base
"abre" ‚Üí "abrir"
"abrir" ‚Üí "abrir"  
"abreme" ‚Üí "abrir"
// 50+ entradas en total
```

#### 2. Estados de Conversaci√≥n
```java
// currentState: Maneja di√°logos multi-paso
"waiting_call_name"     // Esperando nombre para llamada
"waiting_alarm_time"    // Esperando hora para alarma
"waiting_search_term"   // Esperando t√©rmino de b√∫squeda
// 15+ estados diferentes
```

#### 3. Base de Datos Local

**Aplicaciones:**
```java
// Estructura: nombre ‚Üí AppInfo
class AppInfo {
    String name;        // "whatsapp"
    String packageName; // "com.whatsapp"
    String description; // "Aplicaci√≥n de mensajer√≠a..."
}

// Fuentes:
1. Apps instaladas (PackageManager)
2. apps.json en assets (descripciones)
3. SharedPreferences (cach√©)
```

**Contactos:**
```java
class ContactInfo {
    String name;    // "Juan P√©rez"
    String number;  // "+5491134567890"
}

// Fuente: ContentResolver ‚Üí ContactsContract
// Cache: contacts.json en almacenamiento interno
```

**Canciones:**
```java
class SongInfo {
    String name;    // "Bohemian Rhapsody"
    String path;    // "/storage/emulated/0/Music/queen.mp3"
}

// Fuente: MediaStore ‚Üí Audio.Media
// Cache: songs.json en almacenamiento interno
```

### Algoritmos Clave

#### 1. Similitud de Texto (Fuzzy Matching)
```java
private int calculateSimilarity(String s1, String s2) {
    // 1. Coincidencia exacta ‚Üí 100%
    if (s1.equals(s2)) return 100;
    
    // 2. Contenci√≥n parcial ‚Üí 80%
    if (s2.contains(s1) || s1.contains(s2)) return 80;
    
    // 3. Coincidencia por palabras
    String[] words1 = s1.split("\\s+");
    String[] words2 = s2.split("\\s+");
    
    int wordMatches = 0;
    for (String w1 : words1) {
        for (String w2 : words2) {
            if (w1.equals(w2) || w2.contains(w1) || w1.contains(w2)) {
                wordMatches++;
                break;
            }
        }
    }
    
    // 4. Porcentaje basado en palabras coincidentes
    int maxWords = Math.max(words1.length, words2.length);
    return (wordMatches * 100) / maxWords;
}
```

#### 2. Procesamiento de Comandos
```java
public void processCommand(String command) {
    // 1. Normalizaci√≥n
    command = command.trim().toLowerCase();
    
    // 2. Verificar estado de conversaci√≥n
    if (!currentState.isEmpty()) {
        handleStatefulCommand(command);
        return;
    }
    
    // 3. Extraer comando y par√°metros
    String[] parts = command.split("\\s+", 3);
    String key = parts[0];
    String param = parts.length > 1 ? parts[1] : "";
    
    // 4. Buscar en COMMAND_MAP
    String commandType = COMMAND_MAP.get(key);
    
    // 5. B√∫squeda parcial si no hay match exacto
    if (commandType == null) {
        for (Map.Entry<String, String> entry : COMMAND_MAP.entrySet()) {
            if (command.contains(entry.getKey())) {
                commandType = entry.getValue();
                param = command.replace(entry.getKey(), "").trim();
                break;
            }
        }
    }
    
    // 6. Ejecutar comando
    executeCommand(commandType, param);
}
```

### Categor√≠as de Comandos

#### üöÄ **APLICACIONES**
- `abre [nombre]`: Abre aplicaci√≥n instalada
- `lista aplicaciones`: Enumera apps instaladas

#### üìû **LLAMADAS**
- `llama a [contacto]`: Llama por nombre
- `llama al n√∫mero [123]`: Llama por n√∫mero

#### üîç **B√öSQUEDA**
- `busca [t√©rmino]`: B√∫squeda web en Google
- `qu√© es [algo]`: Busca definici√≥n en base local

#### ‚è∞ **TIEMPO Y ALARMAS**
- `pon alarma para [hora]`: Configura alarma
- `qu√© hora es`: Dice fecha y hora actual
- `pon temporizador para [tiempo]`: Timer

#### üîä **SISTEMA**
- `sube volumen`: Aumenta volumen
- `baja volumen`: Disminuye volumen  
- `aumenta brillo`: Sube brillo de pantalla
- `activa wifi`: Abre configuraci√≥n WiFi

#### üì± **MENSAJER√çA**
- `env√≠a mensaje a [contacto] que diga [texto]`: SMS
- `env√≠a email a [correo] asunto [tema] cuerpo [texto]`: Email

#### üéµ **M√öSICA**
- `reproduce [canci√≥n]`: Reproduce m√∫sica local
- `reproduce [canci√≥n] con [app]`: Reproduce con app espec√≠fica
- `lista mi m√∫sica`: Enumera canciones

#### üó∫Ô∏è **NAVEGACI√ìN**
- `navega a [destino]`: Abre Google Maps con ruta

#### üòÑ **INTERACCI√ìN**
- `hola`: Saludo seg√∫n hora del d√≠a
- `cuenta un chiste`: Chiste aleatorio
- `qui√©n eres`: Informaci√≥n del desarrollador
- `gracias` / `de nada`: Cortes√≠as

#### üéÆ **DIVERSI√ìN**
- `pon dinamita`: Comando de juego (Minecraft-style)
- `esc√≥ndete`: Modo discreto (ajusta brillo/volumen)

#### üìã **LISTADOS**
- `lista mis contactos`: Enumera contactos
- `lista aplicaciones`: Enumera apps
- `lista mi m√∫sica`: Enumera canciones

#### ‚ùì **AYUDA**
- `gu√≠a`: Explica todos los comandos disponibles

### Manejo de Par√°metros de Tiempo

#### Parseo de Horas
```java
private Date parseTime(String timeStr) {
    // Entradas soportadas:
    // "8:30" ‚Üí 08:30
    // "8 30" ‚Üí 08:30  
    // "8 de la tarde" ‚Üí 20:00
    // "8 pm" ‚Üí 20:00
    // "20:30" ‚Üí 20:30
    
    // Algoritmo:
    // 1. Detectar AM/PM
    // 2. Extraer n√∫meros
    // 3. Validar rangos
    // 4. Ajustar a 24h
    // 5. Si hora pasada, ma√±ana
}
```

#### Parseo de Duraci√≥n
```java
// Entradas soportadas:
// "5 minutos" ‚Üí 300 segundos
// "1 hora" ‚Üí 3600 segundos
// "2 horas 30 minutos" ‚Üí 9000 segundos

Pattern pat = Pattern.compile("(\\d+)\\s*(horas?|mins?|minutos?|segs?|segundos?)");
```

### Evaluaci√≥n de Expresiones Matem√°ticas
```java
private double evaluateExpression(String expression) {
    // Soporta:
    // Operadores: + - * / ^
    // Funciones: sqrt()
    // Par√©ntesis: ( )
    // N√∫meros decimales: 3.14
    
    // Usa algoritmo Shunting-yard con dos stacks
    // 1. Stack de valores (n√∫meros)
    // 2. Stack de operadores (+, -, *, /, ^)
}
```

### Sistema de Respuestas Aleatorias
```java
private Random random = new Random();
String[] responses = {"Respuesta 1", "Respuesta 2", "Respuesta 3"};
String response = responses[random.nextInt(responses.length)];
```

---

## M√ìDULO MAINACTIVITY

### Prop√≥sito
Actividad principal que gestiona la interfaz de usuario, permisos y coordinaci√≥n entre m√≥dulos.

### Arquitectura de UI

#### Layout Din√°mico
```java
// Construido program√°ticamente (sin XML):
ScrollView ‚Üí RelativeLayout ‚Üí LinearLayout

// Componentes:
1. AudioVisualizerView: Visualizador animado
2. ImageView: Icono de micr√≥fono  
3. TextView (statusText): Estado actual
4. TextView (dialogText): Di√°logo del asistente
5. Button: Bot√≥n de cerrar (‚úï)
```

#### Sistema de Animaciones
```java
// 1. Animaci√≥n de entrada
AnimatorSet entrySet = new AnimatorSet();
entrySet.playTogether(
    ObjectAnimator.ofFloat(root, "alpha", 0f, 1f),
    ObjectAnimator.ofFloat(root, "scaleX", 0.9f, 1f),
    ObjectAnimator.ofFloat(root, "scaleY", 0.9f, 1f)
);
entrySet.setInterpolator(new BounceInterpolator());

// 2. Animaci√≥n de salida  
AnimatorSet exitSet = new AnimatorSet();
exitSet.playTogether(
    ObjectAnimator.ofFloat(root, "alpha", 1f, 0f),
    ObjectAnimator.ofFloat(root, "scaleX", 1f, 0.8f),
    ObjectAnimator.ofFloat(root, "scaleY", 1f, 0.8f)
);
```

#### AudioVisualizerView
```java
// Vista personalizada que simula visualizador de audio
public static class AudioVisualizerView extends View {
    // Caracter√≠sticas:
    - C√≠rculo central que pulsa
    - Ondas conc√©ntricas animadas
    - Sombra y gradiente
    - Animaci√≥n con ValueAnimator
}
```

### Gesti√≥n de Permisos

#### Permisos Peligrosos (Runtime)
```java
private static final String[] DANGEROUS_PERMISSIONS = {
    Manifest.permission.RECORD_AUDIO,      // Micr√≥fono
    Manifest.permission.READ_CONTACTS,     // Contactos
    Manifest.permission.CALL_PHONE,        // Llamadas
    Manifest.permission.CAMERA,            // C√°mara
    Manifest.permission.ACCESS_FINE_LOCATION,  // GPS
    Manifest.permission.SEND_SMS,          // Mensajes
    Manifest.permission.READ_EXTERNAL_STORAGE, // M√∫sica
};
```

#### Permisos Especiales (Settings)
```java
private static final String[] SPECIAL_PERMISSIONS = {
    Manifest.permission.WRITE_SETTINGS,    // Brillo
    Manifest.permission.CHANGE_WIFI_STATE, // WiFi
};
```

#### Flujo de Solicitud
```java
1. Verificar permisos concedidos
2. Solicitar permisos faltantes (requestPermissions)
3. Si denegados ‚Üí redirigir a Settings
4. Si concedidos ‚Üí inicializar app
```

### Estados de la Aplicaci√≥n

```java
// Variables de estado:
boolean isDestroyed = false;      // Actividad destruida
boolean isListening = false;      // Reconocimiento activo  
boolean isSpeaking = false;       // TTS hablando
boolean isPermissionCheckComplete = false; // Permisos listos
```

### Callbacks y Handlers

#### Handler Principal
```java
private Handler mainHandler = new Handler();
// Usado para:
1. Retrasos en reintentos de reconocimiento
2. Transiciones entre estados
3. Actualizaciones UI desde background
```

#### Callbacks de M√≥dulos
```java
// Implementa TTSManager.TTSCallback
@Override public void onSpeechStart() {
    isSpeaking = true;
    stopVoiceRecognition();
}

@Override public void onSpeechDone() {
    isSpeaking = false;
    // Esperar 1s y volver a escuchar
    mainHandler.postDelayed(() -> startVoiceRecognition(), 1000);
}
```

---

## FLUJO DE TRABAJO

### Flujo Principal (Happy Path)
```
1. [INICIO] onCreate() ‚Üí Solicitar permisos
2. [PERMISOS] checkAllPermissions() ‚Üí Inicializar m√≥dulos
3. [ESCUCHA] startVoiceRecognition() ‚Üí Esperar comando
4. [RECONOCIMIENTO] onResult() ‚Üí Procesar texto
5. [PROCESAMIENTO] processCommand() ‚Üí Ejecutar acci√≥n
6. [RESPUESTA] TTSManager.speak() ‚Üí Feedback vocal
7. [RETORNO] onSpeechDone() ‚Üí Volver a paso 3
```

### Flujo de Error
```
1. [ERROR RECONOCIMIENTO] onError() ‚Üí Mostrar mensaje
2. [REINTENTO] Esperar 2s ‚Üí Reintentar escucha
3. [ERROR PERMISOS] Redirigir a Settings ‚Üí Fin app
```

### Estados de Conversaci√≥n (Multi-paso)
```
Ejemplo: Configurar alarma

1. Usuario: "pon alarma"
2. Asistente: "¬øPara qu√© hora la alarma?" (estado: waiting_alarm_time)
3. Usuario: "a las 8 de la ma√±ana"
4. Asistente: "Alarma puesta para las 08:00" (ejecuta acci√≥n)
5. Estado se limpia, vuelve a escucha normal
```

---

## COMANDOS SOPORTADOS

### Categor√≠a: APLICACIONES (abrir)
```
Palabras clave: abre, abrir, abreme, inicia, ejecuta, lanza, corre, lanzar, iniciar
Ejemplo: "abre whatsapp"
Descripci√≥n: Busca aplicaci√≥n por similitud de nombre y la abre
```

### Categor√≠a: LLAMADAS (llamar)
```
Palabras clave: llama, llamar, telefonear, contactar, marca, marcar, ll√°mame
Ejemplo: "llama a mam√°"
Descripci√≥n: Busca contacto por similitud o usa n√∫mero directo
```

### Categor√≠a: B√öSQUEDA (buscar)
```
Palabras clave: busca, buscar, busquemos, encuentra, google, investiga, investigar, b√∫squeda
Ejemplo: "busca recetas de pizza"
Descripci√≥n: Abre navegador con b√∫squeda Google
```

### Categor√≠a: ALARMAS (alarma)
```
Palabras clave: alarma, despertador, alarmas, despierta, despi√©rtame, pon alarma
Ejemplo: "pon alarma para las 7 de la ma√±ana"
Descripci√≥n: Configura alarma en app de reloj
```

### Categor√≠a: VOLUMEN (volumen)
```
Palabras clave: volumen, sonido, audio, ruido, sube volumen, baja volumen
Ejemplo: "sube volumen a 5"
Descripci√≥n: Ajusta volumen multimedia (0-15)
```

### Categor√≠a: BRILLO (brillo)
```
Palabras clave: brillo, luz, iluminacion, pantalla, aumenta brillo, disminuye brillo
Ejemplo: "aumenta brillo"
Descripci√≥n: Ajusta brillo de pantalla (0-255)
```

### Categor√≠a: APAGADO (apagar)
```
Palabras clave: apaga, apagar, cierra, cerrar, termina, finaliza, salir, adi√≥s
Ejemplo: "apagar"
Descripci√≥n: Cierra la aplicaci√≥n
```

### Categor√≠a: HORA (hora)
```
Palabras clave: hora, tiempo, reloj, fecha, d√≠a, qu√© hora es, qu√© d√≠a es
Ejemplo: "qu√© hora es"
Descripci√≥n: Dice fecha y hora actual
```

### Categor√≠a: C√ÅLCULOS (calcular)
```
Palabras clave: calcula, calcular, matematica, cuanto es, suma, multiplica, resta, divide, ra√≠z, potencia
Ejemplo: "calcula 15 * 3"
Descripci√≥n: Eval√∫a expresi√≥n matem√°tica
```

### Categor√≠a: MENSAJES (mensaje)
```
Palabras clave: mensaje, mensajear, texto, sms, whatsapp, envia, enviar, manda
Ejemplo: "env√≠a mensaje a Juan que diga hola"
Descripci√≥n: Abre app de mensajes con texto predefinido
```

### Categor√≠a: NAVEGACI√ìN (navegar)
```
Palabras clave: navega, navegar, mapa, direcciones, ruta, gps
Ejemplo: "navega a casa"
Descripci√≥n: Abre Google Maps con destino
```

### Categor√≠a: M√öSICA (musica)
```
Palabras clave: reproduce, reproducir, m√∫sica, pon m√∫sica, pausa, det√©n
Ejemplo: "reproduce Bohemian Rhapsody"
Descripci√≥n: Busca canci√≥n local y la reproduce
```

### Categor√≠a: TEMPORIZADOR (temporizador)
```
Palabras clave: temporizador, timer, cuenta atr√°s, pon temporizador
Ejemplo: "pon temporizador para 5 minutos"
Descripci√≥n: Configura temporizador en app de reloj
```

### Categor√≠a: RECORDATORIOS (recordatorio)
```
Palabras clave: recordatorio, recu√©rdame, nota, recordar
Ejemplo: "recu√©rdame comprar leche"
Descripci√≥n: Crea evento en calendario
```

### Categor√≠a: CLIMA (clima)
```
Palabras clave: clima, tiempo, pron√≥stico, qu√© tiempo hace
Ejemplo: "clima en Buenos Aires"
Descripci√≥n: Busca clima en Google
```

### Categor√≠a: NOTICIAS (noticias)
```
Palabras clave: noticias, novedades, actualidad
Ejemplo: "noticias tecnolog√≠a"
Descripci√≥n: Busca noticias en Google
```

### Categor√≠a: TRADUCCI√ìN (traducir)
```
Palabras clave: traduce, traducir
Ejemplo: "traduce hola a ingl√©s"
Descripci√≥n: Abre Google Translate
```

### Categor√≠a: WIFI (wifi)
```
Palabras clave: wifi, wi-fi, conexi√≥n, activa wifi, desactiva wifi
Ejemplo: "activa wifi"
Descripci√≥n: Abre configuraci√≥n WiFi
```

### Categor√≠a: BLUETOOTH (bluetooth)
```
Palabras clave: bluetooth, activa bluetooth, desactiva bluetooth
Ejemplo: "activa bluetooth"
Descripci√≥n: Abre configuraci√≥n Bluetooth
```

### Categor√≠a: MODO AVI√ìN (modo_avion)
```
Palabras clave: modo avi√≥n, avi√≥n, activa modo avi√≥n
Ejemplo: "activa modo avi√≥n"
Descripci√≥n: Abre configuraci√≥n modo avi√≥n
```

### Categor√≠a: C√ÅMARA (camara)
```
Palabras clave: foto, toma foto, c√°mara, abre c√°mara
Ejemplo: "abre c√°mara"
Descripci√≥n: Abre app de c√°mara
```

### Categor√≠a: EMAIL (email)
```
Palabras clave: email, correo, env√≠a email
Ejemplo: "env√≠a email a juan@mail.com asunto hola cuerpo c√≥mo est√°s"
Descripci√≥n: Abre cliente email con datos prellenados
```

### Categor√≠a: BATER√çA (bateria)
```
Palabras clave: bater√≠a, carga, nivel bater√≠a
Ejemplo: "nivel bater√≠a"
Descripci√≥n: Dice porcentaje de bater√≠a
```

### Categor√≠a: CHISTES (chiste)
```
Palabras clave: chiste, cuenta un chiste, contame un chiste
Ejemplo: "cuenta un chiste"
Descripci√≥n: Dice chiste aleatorio (15 en base de datos)
```

### Categor√≠a: DINAMITA (dinamita)
```
Palabras clave: pon dinamita
Ejemplo: "pon dinamita"
Descripci√≥n: Comando de juego estilo Minecraft
```

### Categor√≠a: SALUDOS (saludo)
```
Palabras clave: hola, buenos dias, buenas tardes, buenas noches, buen dia, buena tarde, buena noche, hey, saludos
Ejemplo: "hola"
Descripci√≥n: Saludo seg√∫n hora del d√≠a
```

### Categor√≠a: GU√çA (guia)
```
Palabras clave: guia, ayuda, dame una guia de uso, comandos
Ejemplo: "gu√≠a"
Descripci√≥n: Explica todos los comandos disponibles
```

### Categor√≠a: ESCONDER (esconder)
```
Palabras clave: escondete, esconder√©, rapido
Ejemplo: "esc√≥ndete"
Descripci√≥n: Modo discreto (ajusta brillo/volumen)
```

### Categor√≠a: INFORMACI√ìN (info_dev)
```
Palabras clave: quien eres, desarrollador, quien te hizo
Ejemplo: "qui√©n eres"
Descripci√≥n: Informaci√≥n del desarrollador
```

### Categor√≠a: QU√â ES (que_es)
```
Palabras clave: que es, qu√© es
Ejemplo: "qu√© es whatsapp"
Descripci√≥n: Busca descripci√≥n en base de apps
```

### Categor√≠a: CORTES√çAS (gracias/de_nada)
```
Palabras clave: gracias, de nada
Ejemplo: "gracias"
Descripci√≥n: Intercambio de cortes√≠as
```

### Categor√≠a: LISTADOS (lista)
```
Palabras clave: lista, listar, listame, muestrame
Ejemplo: "lista mis contactos"
Descripci√≥n: Enumera contactos, apps o canciones
```

---

## PERMISOS REQUERIDOS

### Permisos de Tiempo de Ejecuci√≥n (Android 6.0+)

| Permiso | Uso | Requerido |
|---------|-----|-----------|
| `RECORD_AUDIO` | Reconocimiento de voz | **S√ç** |
| `READ_CONTACTS` | Acceder a contactos para llamadas/mensajes | **S√ç** |
| `CALL_PHONE` | Realizar llamadas telef√≥nicas | **S√ç** |
| `CAMERA` | Abrir aplicaci√≥n de c√°mara | Opcional |
| `SEND_SMS` | Enviar mensajes de texto | Opcional |
| `READ_EXTERNAL_STORAGE` | Leer archivos de m√∫sica | Opcional |
| `ACCESS_FINE_LOCATION` | Navegaci√≥n GPS | Opcional |

### Permisos Especiales (Configuraci√≥n)

| Permiso | Uso | C√≥mo Conceder |
|---------|-----|---------------|
| `WRITE_SETTINGS` | Ajustar brillo de pantalla | Settings ‚Üí Apps ‚Üí TS Assistant |
| `CHANGE_WIFI_STATE` | Activar/desactivar WiFi | Settings ‚Üí Apps ‚Üí TS Assistant |

### Permisos Impl√≠citos (Declarados en Manifest)

| Permiso | Uso |
|---------|-----|
| `INTERNET` | B√∫squedas web, traducci√≥n |
| `ACCESS_NETWORK_STATE` | Verificar conexi√≥n |
| `WAKE_LOCK` | Mantener pantalla activa |

### Manejo de Permisos Denegados

```java
// Estrategia:
1. Si permiso cr√≠tico (RECORD_AUDIO) denegado ‚Üí App no funciona
2. Si permiso opcional denegado ‚Üí Deshabilitar funcionalidad relacionada
3. Si usuario rechaza ‚Üí Redirigir a Settings despu√©s de explicaci√≥n
4. Si usuario selecciona "Never ask again" ‚Üí Mostrar instrucciones manuales
```

---

## ALMACENAMIENTO DE DATOS

### 1. SharedPreferences
```java
// Archivo: app_prefs.xml
Clave: "apps_cached"        // Apps en cach√©
Clave: "contacts_loaded"    // Flag contactos cargados  
Clave: "songs_loaded"       // Flag canciones cargadas

// Formato apps_cached:
"whatsapp:com.whatsapp;facebook:com.facebook.katana;..."
```

### 2. Archivos JSON Internos

#### contacts.json
```json
[
  {
    "name": "Juan P√©rez",
    "number": "+5491134567890"
  },
  ...
]
```

#### songs.json
```json
[
  {
    "name": "Bohemian Rhapsody",
    "path": "/storage/emulated/0/Music/queen.mp3"
  },
  ...
]
```

### 3. Assets

#### apps.json
```json
{
  "apps": [
    {
      "name": "whatsapp",
      "description": "Aplicaci√≥n de mensajer√≠a instant√°nea"
    },
    {
      "name": "facebook",
      "description": "Red social para conectar con amigos"
    }
  ]
}
```

### 4. Cache en Memoria

#### Estructuras HashMap
```java
Map<String, AppInfo> installedApps;      // Apps por nombre
List<String> installedAppNames;          // Solo nombres
List<ContactInfo> contactsList;          // Contactos
List<SongInfo> songsList;                // Canciones
```

### Flujo de Carga de Datos

```
1. [APPS] onCreate ‚Üí loadInstalledApps()
   ‚îî‚Üí PackageManager ‚Üí installedApps
   ‚îî‚Üí apps.json ‚Üí descriptions
   ‚îî‚Üí SharedPreferences ‚Üí cached apps

2. [CONTACTOS] onCreate ‚Üí loadContacts()
   ‚îî‚Üí Verificar flag contacts_loaded
   ‚îî‚Üí Si true: cargar contacts.json
   ‚îî‚Üí Si false: leer sistema ‚Üí guardar json ‚Üí set flag

3. [CANCIONES] onCreate ‚Üí loadSongs()
   ‚îî‚Üí Verificar flag songs_loaded
   ‚îî‚Üí Si true: cargar songs.json
   ‚îî‚Üí Si false: escanear MediaStore ‚Üí guardar json ‚Üí set flag
```

---

## MANEJO DE ERRORES

### Niveles de Error

#### 1. Errores de Reconocimiento (VoiceRecorder)
```java
// IGNORADOS (modo offline):
ERROR_NETWORK, ERROR_NETWORK_TIMEOUT, ERROR_SERVER

// MANEJADOS:
ERROR_NO_MATCH: "No reconocido"
ERROR_SPEECH_TIMEOUT: "No se detect√≥ voz"
ERROR_AUDIO: "Error de audio"
ERROR_CLIENT: "Error cliente"
ERROR_INSUFFICIENT_PERMISSIONS: "Faltan permisos"
ERROR_RECOGNIZER_BUSY: "Reconocedor ocupado"
```

#### 2. Errores de TTS (TTSManager)
```java
// LANG_MISSING_DATA: Idioma no instalado
// LANG_NOT_SUPPORTED: Idioma no soportado
// Fallback: Usar idioma del sistema
```

#### 3. Errores de Comandos (CommandProcessor)
```java
try {
    executeCommand(command);
} catch (Exception e) {
    tts.speak("Error en el comando");
    Log.e(TAG, "Command error", e);
}
```

#### 4. Errores de Permisos (MainActivity)
```java
// Permiso denegado ‚Üí Redirigir a Settings
// Permiso especial no concedido ‚Üí Continuar sin funcionalidad
```

### Sistema de Reintentos

```java
// VoiceRecorder error ‚Üí Esperar 2s ‚Üí Reintentar
mainHandler.postDelayed(() -> startVoiceRecognition(), 2000);

// TTS error ‚Üí Continuar como si hubiera terminado
callback.onSpeechDone();
```

### Logging y Depuraci√≥n

```java
private static final String TAG = "VoiceRecorder";  // Por clase

// Niveles:
Log.d(TAG, "Mensaje informativo");      // Debug
Log.i(TAG, "Informaci√≥n general");      // Info  
Log.w(TAG, "Advertencia");              // Warning
Log.e(TAG, "Error", exception);         // Error
```

---

## CONSIDERACIONES DE DISE√ëO

### 1. Arquitectura Modular
```
‚úÖ Separaci√≥n clara de responsabilidades
‚úÖ Bajo acoplamiento entre m√≥dulos
‚úÖ F√°cil mantenimiento y testing
```

### 2. Experiencia de Usuario
```
‚úÖ Interfaz minimalista y atractiva
‚úÖ Feedback visual y auditivo
‚úÖ Animaciones suaves
‚úÖ Manejo intuitivo de errores
```

### 3. Performance
```
‚úÖ Cach√© de datos para r√°pido acceso
‚úÖ Operaciones pesadas en background
‚úÖ Liberaci√≥n de recursos en onDestroy
‚úÖ Minimizar uso de memoria
```

### 4. Compatibilidad
```
‚úÖ Soporte para Android 4.0+ (API 14)
‚úÖ Manejo de diferentes versiones de API
‚úÖ Fallbacks para caracter√≠sticas no disponibles
```

### 5. Privacidad
```
‚úÖ Datos almacenados localmente
‚úÖ Sin env√≠o a servidores externos
‚úÖ Permisos solicitados solo cuando son necesarios
‚úÖ Transparencia en uso de datos
```

### 6. Internacionalizaci√≥n
```
‚úÖ Todo en espa√±ol (podr√≠a extenderse)
‚úÖ Formateo de fechas/horas seg√∫n locale
‚úÖ Soportar diferentes formatos num√©ricos
```

### 7. Accesibilidad
```
‚úÖ Contraste adecuado en UI
‚úÖ Tama√±os de texto escalables
‚úÖ Feedback no visual (vibraci√≥n, sonido)
```

---

## LIMITACIONES CONOCIDAS

### 1. Dependencias Externas
```
‚ùå Requiere Google Speech Services para reconocimiento o una alternativa 
‚ùå Requiere TTS engine instalado
‚ùå Algunas funciones requieren apps espec√≠ficas (Maps, Email)
```

### 2. Reconocimiento de Voz
```
‚ùå Calidad depende del motor elegido
‚ùå Sensible a ruido ambiental
‚ùå Requiere entrenamiento para voces espec√≠ficas
```

### 3. Permisos
```
‚ùå Muchos permisos pueden intimidar a usuarios
‚ùå Android 11+ restringe acceso a archivos
‚ùå Permisos de sistema requieren configuraci√≥n manual
```

### 4. Funcionalidad Offline Limitada
```
‚ùå B√∫squedas web requieren conexi√≥n
‚ùå Traducci√≥n requiere conexi√≥n
‚ùå Clima/noticias requieren conexi√≥n
```

### 5. Rendimiento en Dispositivos Antiguos
```
‚ùå Animaciones pueden afectar performance
‚ùå Procesamiento de similitud puede ser lento con muchos datos
‚ùå Uso de memoria con listas grandes
```

---

## MEJORAS FUTURAS POTENCIALES

### 1. Corto Plazo
```
‚úÖ Sistema de plugins/extensions
‚úÖ M√°s comandos personalizados
‚úÖ Mejores algoritmos de similitud
‚úÖ Soporte para atajos de Android
```

### 2. Medio Plazo
```
‚úÖ Versi√≥n servidor para procesamiento en la nube
‚úÖ Aprendizaje de preferencias del usuario
‚úÖ Integraci√≥n con APIs populares (Spotify, Calendar)
‚úÖ Soporte multi-idioma
```

### 3. Largo Plazo
```
‚úÖ Modelo de ML propio para reconocimiento
‚úÖ Sistema de di√°logo contextual
‚úÖ Versi√≥n desktop/escritorio
‚úÖ Ecosistema de dispositivos (wearables, auto)
```

---

## DEPENDENCIAS Y REQUISITOS

### Requisitos M√≠nimos
```
- Android 4.0 (API 14)
- 50MB espacio libre
- Micr√≥fono funcionando
- Servicios de Google Play (para reconocimiento)
```

### Dependencias Impl√≠citas
```
- Google Speech Recognition
- Text-to-Speech engine
- Navegador web (para b√∫squedas)
- App de Contactos (para leer contactos)
- App de M√∫sica (para reproducir)
```

### Compatibilidad Probada
```
‚úÖ Android 5.0+ (√≥ptimo)
‚úÖ Android 4.0-4.4 (funcionalidades limitadas)
‚úÖ Dispositivos con 1GB+ RAM
‚úÖ Pantallas de 4"+ (UI responsive)
```

---

## LICENCIA Y DISTRIBUCI√ìN

### C√≥digo Abierto
```
‚úÖ Licencia MIT/GPL recomendada
‚úÖ Contribuciones bienvenidas
‚úÖ Documentaci√≥n completa
‚úÖ Transparencia total
```

### Distribuci√≥n
```
‚úÖ Google Play Store
‚úÖ F-Droid (versi√≥n libre)
‚úÖ APK directo
‚úÖ C√≥digo fuente en GitHub
```

### Monetizaci√≥n Compatible
```
‚úÖ Donaciones
‚úÖ Versi√≥n Pro con caracter√≠sticas extra
‚úÖ Soporte empresarial
‚úÖ Personalizaciones
```

---

## CR√âDITOS Y CONTRIBUCI√ìN

### Autor Principal
```
Leonardo S. Nivoida
TuringSoftware
Argentina
```

### Estructura de Contribuci√≥n
```
1. Fork del repositorio
2. Crear rama para feature/bugfix
3. Commit con mensajes descriptivos
4. Pull Request con descripci√≥n clara
5. Revisi√≥n y merge
```

### C√≥digo de Conducta
```
‚úÖ Respeto a todos los contribuidores
‚úÖ Discusiones t√©cnicas constructivas
‚úÖ Documentaci√≥n de cambios
‚úÖ Pruebas antes de merge
```

---

**FIN DE LA DOCUMENTACI√ìN**

*Esta documentaci√≥n cubre el 100% del c√≥digo actual de TS Assistant. √öltima actualizaci√≥n: [Fecha]*

Para preguntas o colaboraciones: [Contacto del desarrollador]
